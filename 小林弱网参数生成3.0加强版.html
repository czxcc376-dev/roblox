<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小林弱网参数生成器3.0 - 增强版</title>
    <style>
        :root {
            --primary-color: #3498db;
            --primary-light: #5dade2;
            --primary-dark: #2980b9;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #17a2b8;
            --dark-color: #34495e;
            --light-color: #ecf0f1;
            --border-radius: 10px;
            --box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
            
            /* 默认浅色模式变量 */
            --bg-color: #f5f7fa;
            --card-bg: rgba(255, 255, 255, 0.9);
            --text-color: #2c3e50;
            --text-secondary: #5d6d7e;
            --border-color: #e5e8e8;
            --shadow-color: rgba(0,0,0,0.1);
        }

        /* 深色模式变量 */
        [data-theme="dark"] {
            --bg-color: #1a1a2e;
            --card-bg: rgba(30, 30, 50, 0.9);
            --text-color: #ecf0f1;
            --text-secondary: #bdc3c7;
            --border-color: #2c3e50;
            --shadow-color: rgba(0,0,0,0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #87CEEB 0%, #B0E0E6 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            transition: var(--transition);
        }

        [data-theme="dark"] body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 2.5rem;
            position: relative;
            display: inline-block;
            text-shadow: 1px 1px 3px var(--shadow-color);
        }
        
        h1:after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(to right, var(--primary-light), var(--primary-dark));
            border-radius: 2px;
        }
        
        .subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            max-width: 600px;
            margin: 15px auto 0;
            font-weight: 500;
        }
        
        .brand-info {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
            border-left: 5px solid var(--primary-color);
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }
        
        .brand-title {
            font-size: 1.3rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .brand-desc {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        /* 时间显示区域 */
        .time-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 15px 25px;
            margin-bottom: 25px;
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }
        
        .current-time {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .time-info {
            display: flex;
            gap: 20px;
        }
        
        .time-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .time-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .time-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 6px var(--shadow-color);
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary-light), var(--primary-color));
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(to right, var(--primary-color), var(--primary-dark));
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background-color: var(--card-bg);
            color: var(--dark-color);
            border: 1px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            background-color: var(--card-bg);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px var(--shadow-color);
        }
        
        .btn-history {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
            color: white;
        }
        
        .btn-history:hover {
            background: linear-gradient(to right, #8e44ad, #7d3c98);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(155, 89, 182, 0.3);
        }

        .btn-theme {
            background: linear-gradient(to right, #f39c12, #e67e22);
            color: white;
        }
        
        .btn-theme:hover {
            background: linear-gradient(to right, #e67e22, #d35400);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(243, 156, 18, 0.3);
        }

        .btn-stats {
            background: linear-gradient(to right, #17a2b8, #138496);
            color: white;
        }
        
        .btn-stats:hover {
            background: linear-gradient(to right, #138496, #117a8b);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(23, 162, 184, 0.3);
        }
        
        .btn-share {
            background: linear-gradient(to right, #2ecc71, #27ae60);
            color: white;
        }
        
        .btn-share:hover {
            background: linear-gradient(to right, #27ae60, #219653);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(46, 204, 113, 0.3);
        }

        .btn-custom {
            background: linear-gradient(to right, #9b59b6, #8e44ad);
            color: white;
        }
        
        .btn-custom:hover {
            background: linear-gradient(to right, #8e44ad, #7d3c98);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(155, 89, 182, 0.3);
        }

        .btn-export {
            background: linear-gradient(to right, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn-export:hover {
            background: linear-gradient(to right, #c0392b, #a93226);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(231, 76, 60, 0.3);
        }
        
        .container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 25px;
        }
        
        .panel {
            flex: 1;
            min-width: 320px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }
        
        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px var(--shadow-color);
        }
        
        .panel h2 {
            text-align: center;
            color: var(--text-color);
            padding-bottom: 15px;
            margin-bottom: 20px;
            border-bottom: 2px solid;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .panel.off h2 {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }
        
        .panel.on h2 {
            color: var(--success-color);
            border-color: var(--success-color);
        }
        
        .param-list {
            list-style-type: none;
            padding: 0;
        }
        
        .param-list li {
            padding: 18px 0;
            border-bottom: 1px solid var(--border-color);
            font-size: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .param-list li:hover {
            background-color: rgba(236, 240, 241, 0.5);
            border-radius: 8px;
            padding-left: 10px;
            padding-right: 10px;
        }
        
        .param-list li:last-child {
            border-bottom: none;
        }
        
        .param-info {
            flex: 1;
        }
        
        .param-name {
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
        }
        
        .param-value {
            color: var(--primary-color);
            font-family: "Courier New", Courier, monospace;
            font-weight: bold;
            font-size: 16px;
            background-color: var(--card-bg);
            padding: 6px 12px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 4px var(--shadow-color);
        }
        
        .param-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 35px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .stat-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            text-align: center;
            flex: 1;
            min-width: 160px;
            transition: var(--transition);
            backdrop-filter: blur(5px);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px var(--shadow-color);
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
            text-shadow: 1px 1px 3px var(--shadow-color);
        }
        
        .stat-label {
            font-size: 15px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .network-quality {
            margin-top: 35px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            text-align: center;
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }
        
        .quality-meter {
            height: 24px;
            background-color: var(--border-color);
            border-radius: 12px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 4px var(--shadow-color);
        }
        
        .quality-fill {
            height: 100%;
            border-radius: 12px;
            transition: width 0.7s ease;
            background: linear-gradient(to right, #e74c3c, #f39c12, #2ecc71);
        }
        
        .quality-labels {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .copy-btn {
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 4px var(--shadow-color);
        }
        
        .copy-btn:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(46, 204, 113, 0.3);
        }
        
        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            background-color: var(--success-color);
            color: white;
            padding: 18px 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            transform: translateX(150%);
            transition: transform 0.4s ease;
            z-index: 1000;
            font-weight: 500;
            backdrop-filter: blur(5px);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        /* 历史记录样式 */
        .history-panel {
            margin-top: 35px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .history-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .history-item {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px var(--shadow-color);
            transition: var(--transition);
            border-left: 4px solid var(--primary-color);
        }
        
        .history-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px var(--shadow-color);
        }
        
        .history-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .history-item-title {
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .history-item-actions {
            display: flex;
            gap: 10px;
        }
        
        .history-item-params {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .history-param {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            padding: 5px 0;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .history-param-name {
            color: var(--text-secondary);
        }
        
        .history-param-value {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .clear-history {
            background-color: var(--danger-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .clear-history:hover {
            background-color: #c0392b;
        }

        /* 历史详情模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transition: var(--transition);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
        }
        
        .close-modal:hover {
            color: var(--danger-color);
        }
        
        .modal-params {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .modal-param-group {
            margin-bottom: 20px;
        }
        
        .modal-param-group h4 {
            margin-bottom: 10px;
            color: var(--primary-color);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 5px;
        }
        
        .modal-param {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .modal-param-name {
            color: var(--text-color);
        }
        
        .modal-param-value {
            color: var(--primary-color);
            font-weight: 600;
        }

        /* 使用统计面板 */
        .usage-stats-panel {
            margin-top: 35px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }
        
        .usage-stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .usage-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .usage-stat-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 5px var(--shadow-color);
            transition: var(--transition);
            border-left: 4px solid var(--info-color);
        }
        
        .usage-stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px var(--shadow-color);
        }
        
        .usage-stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--info-color);
            margin-bottom: 8px;
        }
        
        .usage-stat-label {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .reset-stats {
            background-color: var(--warning-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .reset-stats:hover {
            background-color: #e67e22;
        }
        
        /* 分享平台样式 */
        .share-platform-panel {
            margin-top: 35px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }

        .share-platform-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .share-platform-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .search-box {
            display: flex;
            gap: 10px;
        }

        .search-box input, .search-box select {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        .shared-params-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .shared-param-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 2px 5px var(--shadow-color);
            transition: var(--transition);
            border-left: 4px solid var(--primary-color);
        }

        .shared-param-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        .param-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .param-card-title {
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 5px;
        }

        .param-card-author {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .param-card-stats {
            display: flex;
            gap: 15px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .param-card-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .rating-stars {
            color: #f39c12;
            margin: 5px 0;
        }

        /* 自定义参数范围样式 */
        .custom-range-panel {
            margin-top: 35px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            backdrop-filter: blur(5px);
            transition: var(--transition);
        }

        .custom-range-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .range-controls {
            display: flex;
            gap: 10px;
        }

        .range-params-list {
            margin-top: 20px;
        }

        .range-param-item {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px var(--shadow-color);
        }

        .range-param-header {
            margin-bottom: 15px;
        }

        .range-param-header h4 {
            color: var(--text-color);
            margin-bottom: 5px;
        }

        .range-param-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .range-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        .range-inputs {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .range-inputs input {
            width: 80px;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        /* 导出导入控制样式 */
        .import-export-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        /* 导出选项样式 */
        .export-options {
            margin-bottom: 20px;
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            cursor: pointer;
        }

        .option-group input[type="checkbox"] {
            width: auto;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .panel {
                min-width: 100%;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .stats {
                flex-direction: column;
            }
            
            .stat-card {
                min-width: 100%;
            }
            
            .history-item-params {
                grid-template-columns: 1fr;
            }
            
            .modal-params {
                grid-template-columns: 1fr;
            }
            
            .usage-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .time-display {
                flex-direction: column;
                gap: 15px;
            }
            
            .time-info {
                width: 100%;
                justify-content: space-around;
            }

            .shared-params-grid {
                grid-template-columns: 1fr;
            }

            .range-param-controls {
                grid-template-columns: 1fr;
            }

            .share-platform-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .share-platform-controls {
                flex-direction: column;
                width: 100%;
            }

            .search-box {
                width: 100%;
            }

            .search-box input, .search-box select {
                flex: 1;
            }

            .custom-range-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .range-controls {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>小林弱网参数生成器3.0 - 增强版</h1>
        <p class="subtitle">新增参数分享、自定义范围和导出导入功能</p>
    </header>

    <div class="brand-info">
        <div class="brand-title">小林弱网参数生成器3.0 增强版</div>
        <div class="brand-desc">
            官方交流群：870276346 | 新增参数分享平台、自定义参数范围和导出导入功能
        </div>
    </div>

    <!-- 时间显示区域 -->
    <div class="time-display">
        <div class="current-time">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
            </svg>
            <span id="current-time">--:--:--</span>
        </div>
        <div class="time-info">
            <div class="time-item">
                <div class="time-label">当前日期</div>
                <div class="time-value" id="current-date">--/--/----</div>
            </div>
            <div class="time-item">
                <div class="time-label">本次使用时长</div>
                <div class="time-value" id="session-duration">00:00:00</div>
            </div>
            <div class="time-item">
                <div class="time-label">最后生成时间</div>
                <div class="time-value" id="last-generation">--:--:--</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button id="generate-btn" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
            </svg>
            生成新参数
        </button>
        <button id="copy-all-btn" class="btn btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
            </svg>
            复制所有参数
        </button>
        <button id="toggle-history-btn" class="btn btn-history">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>
                <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>
                <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
            </svg>
            显示历史记录
        </button>
        <button id="toggle-share-btn" class="btn btn-share">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                <path d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z"/>
            </svg>
            参数分享平台
        </button>
        <button id="toggle-custom-btn" class="btn btn-custom">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
            </svg>
            自定义参数范围
        </button>
        <button id="toggle-theme-btn" class="btn btn-theme">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
            </svg>
            切换黑白模式
        </button>
        <button id="toggle-stats-btn" class="btn btn-stats">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                <path d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5h-2v12h2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"/>
            </svg>
            使用统计
        </button>
    </div>

    <!-- 导出导入控制 -->
    <div class="import-export-controls">
        <button id="export-params" class="btn btn-export">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
            </svg>
            导出参数
        </button>
        
        <button id="import-params" class="btn btn-export">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
            </svg>
            导入参数
        </button>
        
        <input type="file" id="import-file" accept=".json" style="display: none;">
    </div>

    <div class="container">
        <div class="panel on">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                </svg>
                开启的参数
            </h2>
            <ul id="active-params" class="param-list">
                <!-- 生成的参数将在这里动态显示 -->
            </ul>
        </div>

        <div class="panel off">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
                </svg>
                关闭的参数
            </h2>
            <ul id="inactive-params" class="param-list">
                <!-- 生成的参数将在这里动态显示 -->
            </ul>
        </div>
    </div>

    <div class="stats">
        <div class="stat-card">
            <div class="stat-value" id="avg-latency">0ms</div>
            <div class="stat-label">平均延迟</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="packet-loss">0%</div>
            <div class="stat-label">平均丢包率</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="avg-bandwidth">0kbps</div>
            <div class="stat-label">平均带宽</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="network-score">0</div>
            <div class="stat-label">网络质量评分</div>
        </div>
    </div>

    <div class="network-quality">
        <h3>网络质量评估</h3>
        <div class="quality-meter">
            <div class="quality-fill" id="quality-fill" style="width: 0%;"></div>
        </div>
        <div class="quality-labels">
            <span>极差</span>
            <span>较差</span>
            <span>一般</span>
            <span>良好</span>
            <span>优秀</span>
        </div>
    </div>

    <!-- 历史记录面板 -->
    <div class="history-panel" id="history-panel" style="display: none;">
        <div class="history-header">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>
                    <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>
                    <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
                </svg>
                生成历史
            </h2>
            <button id="clear-history-btn" class="clear-history">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                    <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
                清空历史
            </button>
        </div>
        <div id="history-list" class="history-list">
            <!-- 历史记录将在这里动态显示 -->
        </div>
    </div>

    <!-- 参数分享平台 -->
    <div class="share-platform-panel" id="share-platform-panel" style="display: none;">
        <div class="share-platform-header">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z"/>
                </svg>
                参数分享平台
            </h2>
            <div class="share-platform-controls">
                <button id="share-current-btn" class="btn btn-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/>
                        <path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/>
                    </svg>
                    分享当前参数
                </button>
                <div class="search-box">
                    <input type="text" id="param-search" placeholder="搜索参数配置...">
                    <select id="category-filter">
                        <option value="">全部分类</option>
                        <option value="游戏优化">游戏优化</option>
                        <option value="视频会议">视频会议</option>
                        <option value="直播推流">直播推流</option>
                        <option value="文件传输">文件传输</option>
                        <option value="通用优化">通用优化</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="shared-params-grid" id="shared-params-grid">
            <!-- 共享参数卡片动态生成 -->
        </div>
    </div>

    <!-- 自定义参数范围面板 -->
    <div class="custom-range-panel" id="custom-range-panel" style="display: none;">
        <div class="custom-range-header">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                    <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                </svg>
                自定义参数范围
            </h2>
            <div class="range-controls">
                <button id="save-ranges" class="btn btn-primary">保存范围</button>
                <button id="reset-ranges" class="btn btn-secondary">重置默认</button>
                <button id="import-ranges" class="btn btn-secondary">导入范围</button>
                <button id="export-ranges" class="btn btn-secondary">导出范围</button>
            </div>
        </div>
        
        <div class="range-params-list" id="range-params-list">
            <!-- 参数范围编辑列表动态生成 -->
        </div>
    </div>

    <!-- 使用统计面板 -->
    <div class="usage-stats-panel" id="usage-stats-panel" style="display: none;">
        <div class="usage-stats-header">
            <h2>
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5h-2v12h2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"/>
                </svg>
                使用统计
            </h2>
            <button id="reset-stats-btn" class="reset-stats">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                    <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                </svg>
                重置统计
            </button>
        </div>
        <div class="usage-stats-grid" id="usage-stats-grid">
            <!-- 使用统计将在这里动态显示 -->
        </div>
    </div>

    <!-- 分享参数模态框 -->
    <div id="share-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">分享参数配置</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="share-form">
                <div class="form-group">
                    <label>配置标题</label>
                    <input type="text" id="share-title" placeholder="例如：游戏低延迟优化配置">
                </div>
                <div class="form-group">
                    <label>配置描述</label>
                    <textarea id="share-description" placeholder="描述这个配置的特点和适用场景..."></textarea>
                </div>
                <div class="form-group">
                    <label>分类</label>
                    <select id="share-category">
                        <option value="游戏优化">游戏优化</option>
                        <option value="视频会议">视频会议</option>
                        <option value="直播推流">直播推流</option>
                        <option value="文件传输">文件传输</option>
                        <option value="通用优化">通用优化</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>标签</label>
                    <input type="text" id="share-tags" placeholder="用逗号分隔，例如：游戏,低延迟,优化">
                </div>
                <div class="form-actions">
                    <button id="confirm-share" class="btn btn-primary">确认分享</button>
                    <button id="cancel-share" class="btn btn-secondary">取消</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 导出选项模态框 -->
    <div id="export-options-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">导出参数配置</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="export-options">
                <div class="option-group">
                    <label>
                        <input type="checkbox" id="export-current-params" checked>
                        当前参数值
                    </label>
                    <label>
                        <input type="checkbox" id="export-custom-ranges" checked>
                        自定义参数范围
                    </label>
                    <label>
                        <input type="checkbox" id="export-usage-stats">
                        使用统计信息
                    </label>
                </div>
                <div class="option-group">
                    <label>导出格式</label>
                    <select id="export-format">
                        <option value="json">JSON 格式</option>
                        <option value="text">纯文本格式</option>
                        <option value="csv">CSV 格式</option>
                    </select>
                </div>
            </div>
            <div class="form-actions">
                <button id="confirm-export" class="btn btn-primary">确认导出</button>
                <button id="cancel-export" class="btn btn-secondary">取消</button>
            </div>
        </div>
    </div>

    <!-- 历史详情模态框 -->
    <div id="history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">历史参数详情</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div id="modal-params" class="modal-params">
                <!-- 详细参数将在这里显示 -->
            </div>
        </div>
    </div>

    <div class="notification" id="notification">参数已复制到剪贴板！</div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 原有代码保持不变，新增功能实现将在下面添加
            
            // 获取原有DOM元素
            const generateBtn = document.getElementById('generate-btn');
            const copyAllBtn = document.getElementById('copy-all-btn');
            const toggleHistoryBtn = document.getElementById('toggle-history-btn');
            const toggleThemeBtn = document.getElementById('toggle-theme-btn');
            const toggleStatsBtn = document.getElementById('toggle-stats-btn');
            const clearHistoryBtn = document.getElementById('clear-history-btn');
            const resetStatsBtn = document.getElementById('reset-stats-btn');
            const activeParamsList = document.getElementById('active-params');
            const inactiveParamsList = document.getElementById('inactive-params');
            const historyPanel = document.getElementById('history-panel');
            const historyList = document.getElementById('history-list');
            const usageStatsPanel = document.getElementById('usage-stats-panel');
            const usageStatsGrid = document.getElementById('usage-stats-grid');
            const historyModal = document.getElementById('history-modal');
            const modalParams = document.getElementById('modal-params');
            const closeModalBtn = document.querySelector('.close-modal');
            const notification = document.getElementById('notification');
            
            // 时间显示元素
            const currentTimeEl = document.getElementById('current-time');
            const currentDateEl = document.getElementById('current-date');
            const sessionDurationEl = document.getElementById('session-duration');
            const lastGenerationEl = document.getElementById('last-generation');
            
            // 统计元素
            const avgLatencyEl = document.getElementById('avg-latency');
            const packetLossEl = document.getElementById('packet-loss');
            const avgBandwidthEl = document.getElementById('avg-bandwidth');
            const networkScoreEl = document.getElementById('network-score');
            const qualityFillEl = document.getElementById('quality-fill');

            // 参数定义和范围 - 基于小林弱网参数生成器3.0
            const parameters = [
                {
                    id: 'up_delay',
                    name: '上行延时',
                    description: '数据从设备发送到服务器的延迟时间',
                    unit: 'ms',
                    activeMin: 20,
                    activeMax: 70,
                    inactiveMin: 2,
                    inactiveMax: 20,
                    isActive: true
                },
                {
                    id: 'up_jitter',
                    name: '上行延时抖动',
                    description: '上行延迟的波动幅度',
                    unit: 'ms',
                    activeMin: 4,
                    activeMax: 186,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'up_bandwidth',
                    name: '上行带宽',
                    description: '设备向外发送数据的最大速率',
                    unit: 'kbps',
                    activeMin: 1,
                    activeMax: 3,
                    inactiveMin: 140,
                    inactiveMax: 160,
                    isActive: true
                },
                {
                    id: 'up_rand_loss',
                    name: '上行随机丢包',
                    description: '上行数据包被随机丢弃的概率',
                    unit: '%',
                    activeMin: 0,
                    activeMax: 0,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'up_cont_loss_release',
                    name: '上行连续丢包(放行)',
                    description: '连续丢包期间，数据正常传输的时长',
                    unit: 'ms',
                    activeMin: 0,
                    activeMax: 0,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'up_cont_loss_drop',
                    name: '上行连续丢包(丢包)',
                    description: '模拟上行数据包连续丢失的时长',
                    unit: 'ms',
                    activeMin: 0,
                    activeMax: 0,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'down_delay',
                    name: '下行延时',
                    description: '数据从服务器到达设备的延迟时间',
                    unit: 'ms',
                    activeMin: 40,
                    activeMax: 90,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'down_jitter',
                    name: '下行延时抖动',
                    description: '下行延迟的波动幅度',
                    unit: 'ms',
                    activeMin: 4,
                    activeMax: 60,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'down_bandwidth',
                    name: '下行带宽',
                    description: '设备接收数据的最大速率',
                    unit: 'kbps',
                    activeMin: 4004,
                    activeMax: 9200,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'down_rand_loss',
                    name: '下行随机丢包',
                    description: '下行数据包被随机丢弃的概率',
                    unit: '%',
                    activeMin: 0,
                    activeMax: 0,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'down_cont_loss_release',
                    name: '下行连续丢包(放行)',
                    description: '连续丢包期间，数据正常传输的时长',
                    unit: 'ms',
                    activeMin: 1000,
                    activeMax: 3000,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                },
                {
                    id: 'down_cont_loss_drop',
                    name: '下行连续丢包(丢包)',
                    description: '模拟下行数据包连续丢失的时长',
                    unit: 'ms',
                    activeMin: 0,
                    activeMax: 0,
                    inactiveMin: 0,
                    inactiveMax: 0,
                    isActive: true
                }
            ];

            // 历史记录数组
            let history = JSON.parse(localStorage.getItem('weakNetworkHistory')) || [];
            let currentParams = {};

            // 使用统计数据
            let usageStats = JSON.parse(localStorage.getItem('weakNetworkUsageStats')) || {
                totalGenerations: 0,
                totalCopies: 0,
                totalHistoryCopies: 0,
                totalHistoryApplications: 0,
                totalThemeSwitches: 0,
                totalHistoryViews: 0,
                firstUseDate: new Date().toISOString(),
                lastUseDate: new Date().toISOString()
            };

            // 时间相关变量
            let sessionStartTime = new Date();
            let lastGenerationTime = null;

            // 主题状态
            let isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.documentElement.setAttribute('data-theme', 'dark');
                toggleThemeBtn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
                    </svg>
                    切换浅色模式
                `;
            }

            // ========== 新增功能实现 ==========

            // 获取新增DOM元素
            const toggleShareBtn = document.getElementById('toggle-share-btn');
            const toggleCustomBtn = document.getElementById('toggle-custom-btn');
            const exportParamsBtn = document.getElementById('export-params');
            const importParamsBtn = document.getElementById('import-params');
            const importFileInput = document.getElementById('import-file');
            const sharePlatformPanel = document.getElementById('share-platform-panel');
            const customRangePanel = document.getElementById('custom-range-panel');
            const rangeParamsList = document.getElementById('range-params-list');
            const sharedParamsGrid = document.getElementById('shared-params-grid');
            const shareCurrentBtn = document.getElementById('share-current-btn');
            const paramSearch = document.getElementById('param-search');
            const categoryFilter = document.getElementById('category-filter');
            const shareModal = document.getElementById('share-modal');
            const exportOptionsModal = document.getElementById('export-options-modal');
            const saveRangesBtn = document.getElementById('save-ranges');
            const resetRangesBtn = document.getElementById('reset-ranges');
            const importRangesBtn = document.getElementById('import-ranges');
            const exportRangesBtn = document.getElementById('export-ranges');
            const confirmShareBtn = document.getElementById('confirm-share');
            const cancelShareBtn = document.getElementById('cancel-share');
            const confirmExportBtn = document.getElementById('confirm-export');
            const cancelExportBtn = document.getElementById('cancel-export');

            // 分享平台数据
            let sharedParams = JSON.parse(localStorage.getItem('weakNetworkSharedParams')) || [];

            // 自定义参数范围
            let customRanges = JSON.parse(localStorage.getItem('weakNetworkCustomRanges')) || JSON.parse(JSON.stringify(parameters));

            // 时间更新函数
            function updateTime() {
                const now = new Date();
                
                // 更新当前时间
                const timeString = now.toLocaleTimeString('zh-CN');
                currentTimeEl.textContent = timeString;
                
                // 更新当前日期
                const dateString = now.toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                });
                currentDateEl.textContent = dateString;

                // 更新本次使用时长
                const sessionDuration = Math.floor((now - sessionStartTime) / 1000);
                const hours = Math.floor(sessionDuration / 3600);
                const minutes = Math.floor((sessionDuration % 3600) / 60);
                const seconds = sessionDuration % 60;
                sessionDurationEl.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // 更新最后生成时间（如果有的话）
                if (lastGenerationTime) {
                    const lastGenString = lastGenerationTime.toLocaleTimeString('zh-CN');
                    lastGenerationEl.textContent = lastGenString;
                }
            }

            function generateRandomValue(min, max) {
                const range = max - min;
                let randomValue = Math.random() * range + min;
                return Math.round(randomValue);
            }

            function generateParameters() {
                // 更新使用统计
                updateUsageStats('totalGenerations');
                
                // 更新最后生成时间
                lastGenerationTime = new Date();
                
                // 清空列表
                activeParamsList.innerHTML = '';
                inactiveParamsList.innerHTML = '';

                // 计算统计数据
                let totalLatency = 0;
                let totalPacketLoss = 0;
                let totalBandwidth = 0;
                let paramCount = 0;

                // 当前生成的参数
                currentParams = {
                    timestamp: new Date().toLocaleString(),
                    activeParams: {},
                    inactiveParams: {},
                    stats: {}
                };

                // 填充开启的参数列表
                parameters.forEach(param => {
                    const li = document.createElement('li');
                    
                    // 添加复制按钮
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn';
                    copyBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                        复制
                    `;
                    
                    // 确定开启状态的参数值 - 使用自定义范围
                    const customParam = customRanges.find(p => p.id === param.id) || param;
                    let activeValue = generateRandomValue(customParam.activeMin, customParam.activeMax);
                    currentParams.activeParams[param.id] = {
                        name: param.name,
                        value: activeValue,
                        unit: param.unit,
                        description: param.description
                    };
                    
                    copyBtn.addEventListener('click', () => {
                        copyToClipboard(`${param.name}: ${activeValue}${param.unit}`);
                        showNotification(`${param.name} 参数已复制`);
                        updateUsageStats('totalCopies');
                    });
                    
                    li.innerHTML = `
                        <div class="param-info">
                            <div class="param-name">
                                ${param.name}
                            </div>
                            <div class="param-desc">${param.description}</div>
                        </div>
                        <span class="param-value">${activeValue} ${param.unit}</span>
                    `;
                    
                    li.appendChild(copyBtn);
                    activeParamsList.appendChild(li);
                    
                    // 计算统计数据（只计算数值型参数）
                    if (param.id.includes('delay') || param.id.includes('jitter')) {
                        totalLatency += parseFloat(activeValue);
                        paramCount++;
                    } else if (param.id.includes('loss')) {
                        totalPacketLoss += parseFloat(activeValue);
                        paramCount++;
                    } else if (param.id.includes('bandwidth')) {
                        totalBandwidth += parseFloat(activeValue);
                        paramCount++;
                    }
                });

                // 填充关闭的参数列表
                parameters.forEach(param => {
                    const li = document.createElement('li');
                    
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn';
                    copyBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                        复制
                    `;
                    
                    // 确定关闭状态的参数值 - 使用自定义范围
                    const customParam = customRanges.find(p => p.id === param.id) || param;
                    let inactiveValue;
                    if (param.id === 'up_delay') {
                        inactiveValue = generateRandomValue(customParam.inactiveMin, customParam.inactiveMax);
                    } else if (param.id === 'up_bandwidth') {
                        inactiveValue = generateRandomValue(customParam.inactiveMin, customParam.inactiveMax);
                    } else {
                        inactiveValue = 0;
                    }
                    
                    currentParams.inactiveParams[param.id] = {
                        name: param.name,
                        value: inactiveValue,
                        unit: param.unit,
                        description: param.description
                    };
                    
                    copyBtn.addEventListener('click', () => {
                        copyToClipboard(`${param.name}: ${inactiveValue}${param.unit}`);
                        showNotification(`${param.name} 参数已复制`);
                        updateUsageStats('totalCopies');
                    });
                    
                    li.innerHTML = `
                        <div class="param-info">
                            <div class="param-name">
                                ${param.name}
                            </div>
                            <div class="param-desc">${param.description}</div>
                        </div>
                        <span class="param-value">${inactiveValue} ${param.unit}</span>
                    `;
                    
                    li.appendChild(copyBtn);
                    inactiveParamsList.appendChild(li);
                });

                // 更新统计信息
                const stats = updateStats(totalLatency, totalPacketLoss, totalBandwidth, paramCount);
                currentParams.stats = stats;
                
                // 添加到历史记录
                addToHistory(currentParams);
            }

            function updateStats(totalLatency, totalPacketLoss, totalBandwidth, paramCount) {
                // 计算平均值
                const avgLatency = Math.round(totalLatency / paramCount);
                const avgPacketLoss = Math.round(totalPacketLoss / paramCount);
                const avgBandwidth = Math.round(totalBandwidth / paramCount);
                
                // 计算网络质量评分 (0-100)
                let networkScore = 100;
                
                // 延迟影响 (越高分数越低)
                if (avgLatency > 100) networkScore -= 40;
                else if (avgLatency > 50) networkScore -= 20;
                else if (avgLatency > 20) networkScore -= 10;
                
                // 丢包率影响
                if (avgPacketLoss > 10) networkScore -= 30;
                else if (avgPacketLoss > 5) networkScore -= 15;
                else if (avgPacketLoss > 1) networkScore -= 5;
                
                // 带宽影响
                if (avgBandwidth < 1000) networkScore -= 20;
                else if (avgBandwidth < 2000) networkScore -= 10;
                
                // 确保分数在0-100之间
                networkScore = Math.max(0, Math.min(100, networkScore));
                
                // 更新UI
                avgLatencyEl.textContent = `${avgLatency}ms`;
                packetLossEl.textContent = `${avgPacketLoss}%`;
                avgBandwidthEl.textContent = `${avgBandwidth}kbps`;
                networkScoreEl.textContent = networkScore;
                
                // 更新网络质量指示器
                updateQualityIndicator(networkScore);
                
                return {
                    avgLatency,
                    avgPacketLoss,
                    avgBandwidth,
                    networkScore
                };
            }

            function updateQualityIndicator(score) {
                const fill = document.getElementById('quality-fill');
                fill.style.width = `${score}%`;
            }

            function addToHistory(params) {
                // 添加到历史记录数组的开头
                history.unshift(params);
                
                // 限制历史记录数量（最多10条）
                if (history.length > 10) {
                    history = history.slice(0, 10);
                }
                
                // 保存到本地存储
                localStorage.setItem('weakNetworkHistory', JSON.stringify(history));
                
                // 更新历史记录面板
                updateHistoryPanel();
            }

            function updateHistoryPanel() {
                historyList.innerHTML = '';
                
                if (history.length === 0) {
                    historyList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">暂无历史记录</p>';
                    return;
                }
                
                history.forEach((item, index) => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    
                    const historyItemHeader = document.createElement('div');
                    historyItemHeader.className = 'history-item-header';
                    
                    const historyItemTitle = document.createElement('div');
                    historyItemTitle.className = 'history-item-title';
                    historyItemTitle.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>
                        </svg>
                        生成时间: ${item.timestamp}
                    `;
                    
                    const historyItemActions = document.createElement('div');
                    historyItemActions.className = 'history-item-actions';
                    
                    const copyHistoryBtn = document.createElement('button');
                    copyHistoryBtn.className = 'copy-btn';
                    copyHistoryBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                        复制
                    `;
                    
                    copyHistoryBtn.addEventListener('click', () => {
                        copyHistoryParams(item);
                        updateUsageStats('totalHistoryCopies');
                    });
                    
                    const applyHistoryBtn = document.createElement('button');
                    applyHistoryBtn.className = 'copy-btn';
                    applyHistoryBtn.style.backgroundColor = 'var(--primary-color)';
                    applyHistoryBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                        </svg>
                        应用
                    `;
                    
                    applyHistoryBtn.addEventListener('click', () => {
                        applyHistoryParams(item);
                        updateUsageStats('totalHistoryApplications');
                    });
                    
                    const viewDetailsBtn = document.createElement('button');
                    viewDetailsBtn.className = 'copy-btn';
                    viewDetailsBtn.style.backgroundColor = 'var(--warning-color)';
                    viewDetailsBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/>
                            <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/>
                        </svg>
                        详情
                    `;

                    viewDetailsBtn.addEventListener('click', () => {
                        showHistoryDetails(item);
                        updateUsageStats('totalHistoryViews');
                    });
                    
                    historyItemActions.appendChild(copyHistoryBtn);
                    historyItemActions.appendChild(applyHistoryBtn);
                    historyItemActions.appendChild(viewDetailsBtn);
                    
                    historyItemHeader.appendChild(historyItemTitle);
                    historyItemHeader.appendChild(historyItemActions);
                    
                    const historyItemParams = document.createElement('div');
                    historyItemParams.className = 'history-item-params';
                    
                    // 添加统计信息
                    const statsParam = document.createElement('div');
                    statsParam.className = 'history-param';
                    statsParam.innerHTML = `
                        <span class="history-param-name">网络评分</span>
                        <span class="history-param-value">${item.stats.networkScore}</span>
                    `;
                    historyItemParams.appendChild(statsParam);
                    
                    // 添加关键参数
                    Object.keys(item.activeParams).slice(0, 4).forEach(key => {
                        const param = item.activeParams[key];
                        const paramEl = document.createElement('div');
                        paramEl.className = 'history-param';
                        paramEl.innerHTML = `
                            <span class="history-param-name">${param.name}</span>
                            <span class="history-param-value">${param.value}${param.unit}</span>
                        `;
                        historyItemParams.appendChild(paramEl);
                    });
                    
                    historyItem.appendChild(historyItemHeader);
                    historyItem.appendChild(historyItemParams);
                    historyList.appendChild(historyItem);
                });
            }

            function showHistoryDetails(historyItem) {
                modalParams.innerHTML = '';
                
                // 添加统计信息
                const statsGroup = document.createElement('div');
                statsGroup.className = 'modal-param-group';
                statsGroup.innerHTML = '<h4>统计信息</h4>';
                
                const statsParams = document.createElement('div');
                statsParams.className = 'modal-params';
                
                const latencyParam = document.createElement('div');
                latencyParam.className = 'modal-param';
                latencyParam.innerHTML = `
                    <span class="modal-param-name">平均延迟</span>
                    <span class="modal-param-value">${historyItem.stats.avgLatency}ms</span>
                `;
                
                const lossParam = document.createElement('div');
                lossParam.className = 'modal-param';
                lossParam.innerHTML = `
                    <span class="modal-param-name">平均丢包率</span>
                    <span class="modal-param-value">${historyItem.stats.avgPacketLoss}%</span>
                `;
                
                const bandwidthParam = document.createElement('div');
                bandwidthParam.className = 'modal-param';
                bandwidthParam.innerHTML = `
                    <span class="modal-param-name">平均带宽</span>
                    <span class="modal-param-value">${historyItem.stats.avgBandwidth}kbps</span>
                `;
                
                const scoreParam = document.createElement('div');
                scoreParam.className = 'modal-param';
                scoreParam.innerHTML = `
                    <span class="modal-param-name">网络质量评分</span>
                    <span class="modal-param-value">${historyItem.stats.networkScore}</span>
                `;
                
                statsParams.appendChild(latencyParam);
                statsParams.appendChild(lossParam);
                statsParams.appendChild(bandwidthParam);
                statsParams.appendChild(scoreParam);
                statsGroup.appendChild(statsParams);
                modalParams.appendChild(statsGroup);

                // 添加上行参数
                const upGroup = document.createElement('div');
                upGroup.className = 'modal-param-group';
                upGroup.innerHTML = '<h4>上行参数</h4>';
                
                const upParams = document.createElement('div');
                upParams.className = 'modal-params';
                
                Object.keys(historyItem.activeParams).forEach(key => {
                    if (key.startsWith('up_')) {
                        const param = historyItem.activeParams[key];
                        const paramEl = document.createElement('div');
                        paramEl.className = 'modal-param';
                        paramEl.innerHTML = `
                            <span class="modal-param-name">${param.name}</span>
                            <span class="modal-param-value">${param.value}${param.unit}</span>
                        `;
                        upParams.appendChild(paramEl);
                    }
                });
                
                upGroup.appendChild(upParams);
                modalParams.appendChild(upGroup);
                
                // 添加下行参数
                const downGroup = document.createElement('div');
                downGroup.className = 'modal-param-group';
                downGroup.innerHTML = '<h4>下行参数</h4>';
                
                const downParams = document.createElement('div');
                downParams.className = 'modal-params';
                
                Object.keys(historyItem.activeParams).forEach(key => {
                    if (key.startsWith('down_')) {
                        const param = historyItem.activeParams[key];
                        const paramEl = document.createElement('div');
                        paramEl.className = 'modal-param';
                        paramEl.innerHTML = `
                            <span class="modal-param-name">${param.name}</span>
                            <span class="modal-param-value">${param.value}${param.unit}</span>
                        `;
                        downParams.appendChild(paramEl);
                    }
                });
                
                downGroup.appendChild(downParams);
                modalParams.appendChild(downGroup);
                
                // 显示模态框
                historyModal.style.display = 'flex';
            }

            function copyHistoryParams(historyItem) {
                let allParams = '';
                
                // 收集开启的参数
                Object.keys(historyItem.activeParams).forEach(key => {
                    const param = historyItem.activeParams[key];
                    allParams += `${param.name}: ${param.value}${param.unit}\n`;
                });
                
                // 收集关闭的参数
                Object.keys(historyItem.inactiveParams).forEach(key => {
                    const param = historyItem.inactiveParams[key];
                    allParams += `${param.name}: ${param.value}${param.unit}\n`;
                });
                
                copyToClipboard(allParams);
                showNotification('历史参数已复制到剪贴板！');
            }

            function applyHistoryParams(historyItem) {
                // 清空当前显示
                activeParamsList.innerHTML = '';
                inactiveParamsList.innerHTML = '';
                
                // 应用历史参数到当前显示
                Object.keys(historyItem.activeParams).forEach(key => {
                    const param = historyItem.activeParams[key];
                    const li = document.createElement('li');
                    
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn';
                    copyBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                        复制
                    `;
                    
                    copyBtn.addEventListener('click', () => {
                        copyToClipboard(`${param.name}: ${param.value}${param.unit}`);
                        showNotification(`${param.name} 参数已复制`);
                        updateUsageStats('totalCopies');
                    });
                    
                    li.innerHTML = `
                        <div class="param-info">
                            <div class="param-name">
                                ${param.name}
                            </div>
                            <div class="param-desc">${param.description}</div>
                        </div>
                        <span class="param-value">${param.value} ${param.unit}</span>
                    `;
                    
                    li.appendChild(copyBtn);
                    activeParamsList.appendChild(li);
                });
                
                Object.keys(historyItem.inactiveParams).forEach(key => {
                    const param = historyItem.inactiveParams[key];
                    const li = document.createElement('li');
                    
                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn';
                    copyBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                        复制
                    `;
                    
                    copyBtn.addEventListener('click', () => {
                        copyToClipboard(`${param.name}: ${param.value}${param.unit}`);
                        showNotification(`${param.name} 参数已复制`);
                        updateUsageStats('totalCopies');
                    });
                    
                    li.innerHTML = `
                        <div class="param-info">
                            <div class="param-name">
                                ${param.name}
                            </div>
                            <div class="param-desc">${param.description}</div>
                        </div>
                        <span class="param-value">${param.value} ${param.unit}</span>
                    `;
                    
                    li.appendChild(copyBtn);
                    inactiveParamsList.appendChild(li);
                });
                
                // 更新统计信息
                avgLatencyEl.textContent = `${historyItem.stats.avgLatency}ms`;
                packetLossEl.textContent = `${historyItem.stats.avgPacketLoss}%`;
                avgBandwidthEl.textContent = `${historyItem.stats.avgBandwidth}kbps`;
                networkScoreEl.textContent = historyItem.stats.networkScore;
                updateQualityIndicator(historyItem.stats.networkScore);
                
                showNotification('历史参数已应用到当前界面！');
            }

            function copyToClipboard(text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            }

            function copyAllParameters() {
                let allParams = '';
                
                // 收集开启的参数
                parameters.forEach(param => {
                    const customParam = customRanges.find(p => p.id === param.id) || param;
                    const activeValue = generateRandomValue(customParam.activeMin, customParam.activeMax);
                    allParams += `${param.name}: ${activeValue}${param.unit}\n`;
                });
                
                // 收集关闭的参数
                parameters.forEach(param => {
                    const customParam = customRanges.find(p => p.id === param.id) || param;
                    let inactiveValue;
                    if (param.id === 'up_delay') {
                        inactiveValue = generateRandomValue(customParam.inactiveMin, customParam.inactiveMax);
                    } else if (param.id === 'up_bandwidth') {
                        inactiveValue = generateRandomValue(customParam.inactiveMin, customParam.inactiveMax);
                    } else {
                        inactiveValue = 0;
                    }
                    allParams += `${param.name}: ${inactiveValue}${param.unit}\n`;
                });
                
                copyToClipboard(allParams);
                showNotification('所有参数已复制到剪贴板！');
                updateUsageStats('totalCopies');
            }

            function showNotification(message) {
                notification.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }

            function toggleHistoryPanel() {
                if (historyPanel.style.display === 'none') {
                    historyPanel.style.display = 'block';
                    toggleHistoryBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
                        </svg>
                        隐藏历史记录
                    `;
                } else {
                    historyPanel.style.display = 'none';
                    toggleHistoryBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>
                            <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>
                            <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
                        </svg>
                        显示历史记录
                    `;
                }
            }

            function toggleStatsPanel() {
                if (usageStatsPanel.style.display === 'none') {
                    usageStatsPanel.style.display = 'block';
                    toggleStatsBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
                        </svg>
                        隐藏统计
                    `;
                } else {
                    usageStatsPanel.style.display = 'none';
                    toggleStatsBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5h-2v12h2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"/>
                        </svg>
                        使用统计
                    `;
                }
            }

            function toggleTheme() {
                isDarkMode = !isDarkMode;
                localStorage.setItem('darkMode', isDarkMode);
                updateUsageStats('totalThemeSwitches');
                
                if (isDarkMode) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    toggleThemeBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
                        </svg>
                        切换浅色模式
                    `;
                } else {
                    document.documentElement.removeAttribute('data-theme');
                    toggleThemeBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
                        </svg>
                        切换黑白模式
                    `;
                }
            }

            function updateUsageStats(statType) {
                // 更新使用统计
                usageStats[statType]++;
                usageStats.lastUseDate = new Date().toISOString();
                
                // 保存到本地存储
                localStorage.setItem('weakNetworkUsageStats', JSON.stringify(usageStats));
                
                // 更新统计显示
                updateUsageStatsDisplay();
            }

            function updateUsageStatsDisplay() {
                usageStatsGrid.innerHTML = '';
                
                // 计算使用天数
                const firstUseDate = new Date(usageStats.firstUseDate);
                const lastUseDate = new Date(usageStats.lastUseDate);
                const daysUsed = Math.ceil((lastUseDate - firstUseDate) / (1000 * 60 * 60 * 24));
                
                // 创建统计卡片
                const statsData = [
                    { label: '参数生成次数', value: usageStats.totalGenerations },
                    { label: '参数复制次数', value: usageStats.totalCopies },
                    { label: '历史记录复制', value: usageStats.totalHistoryCopies },
                    { label: '历史记录应用', value: usageStats.totalHistoryApplications },
                    { label: '主题切换次数', value: usageStats.totalThemeSwitches },
                    { label: '历史详情查看', value: usageStats.totalHistoryViews },
                    { label: '使用天数', value: daysUsed },
                    { label: '历史记录数量', value: history.length }
                ];
                
                statsData.forEach(stat => {
                    const statCard = document.createElement('div');
                    statCard.className = 'usage-stat-card';
                    statCard.innerHTML = `
                        <div class="usage-stat-value">${stat.value}</div>
                        <div class="usage-stat-label">${stat.label}</div>
                    `;
                    usageStatsGrid.appendChild(statCard);
                });
            }

            function resetStats() {
                if (confirm('确定要重置所有使用统计吗？此操作不可撤销。')) {
                    usageStats = {
                        totalGenerations: 0,
                        totalCopies: 0,
                        totalHistoryCopies: 0,
                        totalHistoryApplications: 0,
                        totalThemeSwitches: 0,
                        totalHistoryViews: 0,
                        firstUseDate: new Date().toISOString(),
                        lastUseDate: new Date().toISOString()
                    };
                    
                    localStorage.setItem('weakNetworkUsageStats', JSON.stringify(usageStats));
                    updateUsageStatsDisplay();
                    showNotification('使用统计已重置');
                }
            }

            function clearHistory() {
                if (confirm('确定要清空所有历史记录吗？此操作不可撤销。')) {
                    history = [];
                    localStorage.removeItem('weakNetworkHistory');
                    updateHistoryPanel();
                    updateUsageStatsDisplay();
                    showNotification('历史记录已清空');
                }
            }

            // ========== 新增功能实现 ==========

            // 切换分享平台显示
            function toggleSharePanel() {
                if (sharePlatformPanel.style.display === 'none') {
                    sharePlatformPanel.style.display = 'block';
                    toggleShareBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
                        </svg>
                        隐藏分享平台
                    `;
                    updateSharedParamsDisplay();
                } else {
                    sharePlatformPanel.style.display = 'none';
                    toggleShareBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z"/>
                        </svg>
                        参数分享平台
                    `;
                }
            }

            // 切换自定义参数范围面板
            function toggleCustomPanel() {
                if (customRangePanel.style.display === 'none') {
                    customRangePanel.style.display = 'block';
                    toggleCustomBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
                        </svg>
                        隐藏自定义范围
                    `;
                    updateCustomRangesDisplay();
                } else {
                    customRangePanel.style.display = 'none';
                    toggleCustomBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                        </svg>
                        自定义参数范围
                    `;
                }
            }

            // 更新共享参数显示
            function updateSharedParamsDisplay() {
                sharedParamsGrid.innerHTML = '';
                
                if (sharedParams.length === 0) {
                    sharedParamsGrid.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">暂无共享参数，点击"分享当前参数"来分享您的第一个配置！</p>';
                    return;
                }
                
                // 获取搜索和筛选条件
                const searchTerm = paramSearch.value.toLowerCase();
                const category = categoryFilter.value;
                
                // 筛选参数
                const filteredParams = sharedParams.filter(param => {
                    const matchesSearch = param.title.toLowerCase().includes(searchTerm) || 
                                         param.description.toLowerCase().includes(searchTerm) ||
                                         param.tags.some(tag => tag.toLowerCase().includes(searchTerm));
                    const matchesCategory = !category || param.category === category;
                    return matchesSearch && matchesCategory;
                });
                
                if (filteredParams.length === 0) {
                    sharedParamsGrid.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">没有找到匹配的共享参数</p>';
                    return;
                }
                
                // 显示筛选后的参数
                filteredParams.forEach(param => {
                    const paramCard = document.createElement('div');
                    paramCard.className = 'shared-param-card';
                    
                    // 生成星级评分
                    const stars = '★'.repeat(Math.round(param.rating)) + '☆'.repeat(5 - Math.round(param.rating));
                    
                    paramCard.innerHTML = `
                        <div class="param-card-header">
                            <div>
                                <div class="param-card-title">${param.title}</div>
                                <div class="param-card-author">作者: ${param.author} | ${param.createTime}</div>
                            </div>
                            <div class="param-card-stats">
                                <span>下载: ${param.downloads}</span>
                                <span>评分: ${param.rating}</span>
                            </div>
                        </div>
                        <div class="rating-stars">${stars}</div>
                        <p>${param.description}</p>
                        <div class="param-card-actions">
                            <button class="copy-btn apply-shared-param" data-id="${param.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                                </svg>
                                应用
                            </button>
                            <button class="copy-btn" style="background-color: var(--primary-color);" onclick="downloadSharedParam('${param.id}')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                                </svg>
                                下载
                            </button>
                            <button class="copy-btn" style="background-color: var(--warning-color);" onclick="rateSharedParam('${param.id}')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.283.95l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                                </svg>
                                评分
                            </button>
                        </div>
                    `;
                    
                    sharedParamsGrid.appendChild(paramCard);
                });
                
                // 为应用按钮添加事件监听
                document.querySelectorAll('.apply-shared-param').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const paramId = this.getAttribute('data-id');
                        applySharedParam(paramId);
                    });
                });
            }

            // 应用共享参数
            function applySharedParam(paramId) {
                const sharedParam = sharedParams.find(p => p.id === paramId);
                if (sharedParam) {
                    applyHistoryParams(sharedParam.parameters);
                    // 增加下载次数
                    sharedParam.downloads++;
                    localStorage.setItem('weakNetworkSharedParams', JSON.stringify(sharedParams));
                    updateSharedParamsDisplay();
                    showNotification(`已应用共享参数: ${sharedParam.title}`);
                }
            }

            // 下载共享参数
            function downloadSharedParam(paramId) {
                const sharedParam = sharedParams.find(p => p.id === paramId);
                if (sharedParam) {
                    // 增加下载次数
                    sharedParam.downloads++;
                    localStorage.setItem('weakNetworkSharedParams', JSON.stringify(sharedParams));
                    
                    // 创建下载
                    const dataStr = JSON.stringify(sharedParam.parameters, null, 2);
                    const dataBlob = new Blob([dataStr], {type: 'application/json'});
                    
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(dataBlob);
                    link.download = `弱网参数_${sharedParam.title}.json`;
                    link.click();
                    
                    URL.revokeObjectURL(link.href);
                    updateSharedParamsDisplay();
                    showNotification(`已下载共享参数: ${sharedParam.title}`);
                }
            }

            // 评分共享参数
            function rateSharedParam(paramId) {
                const rating = prompt('请为这个参数配置评分 (1-5分):');
                if (rating && rating >= 1 && rating <= 5) {
                    const sharedParam = sharedParams.find(p => p.id === paramId);
                    if (sharedParam) {
                        // 更新评分 (简单平均)
                        sharedParam.rating = ((sharedParam.rating * sharedParam.downloads) + parseFloat(rating)) / (sharedParam.downloads + 1);
                        localStorage.setItem('weakNetworkSharedParams', JSON.stringify(sharedParams));
                        updateSharedParamsDisplay();
                        showNotification(`感谢您的评分!`);
                    }
                } else if (rating !== null) {
                    alert('请输入1-5之间的数字');
                }
            }

            // 分享当前参数
            function shareCurrentParams() {
                // 显示分享模态框
                shareModal.style.display = 'flex';
                
                // 重置表单
                document.getElementById('share-title').value = '';
                document.getElementById('share-description').value = '';
                document.getElementById('share-category').value = '游戏优化';
                document.getElementById('share-tags').value = '';
            }

            // 确认分享参数
            function confirmShare() {
                const title = document.getElementById('share-title').value.trim();
                const description = document.getElementById('share-description').value.trim();
                const category = document.getElementById('share-category').value;
                const tags = document.getElementById('share-tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
                
                if (!title) {
                    alert('请输入配置标题');
                    return;
                }
                
                if (!description) {
                    alert('请输入配置描述');
                    return;
                }
                
                // 创建共享参数对象
                const sharedParam = {
                    id: 'shared_' + Date.now(),
                    title,
                    description,
                    author: '用户' + Math.floor(Math.random() * 10000),
                    createTime: new Date().toLocaleDateString(),
                    downloads: 0,
                    rating: 5, // 初始评分
                    tags,
                    category,
                    parameters: currentParams
                };
                
                // 添加到共享参数列表
                sharedParams.unshift(sharedParam);
                localStorage.setItem('weakNetworkSharedParams', JSON.stringify(sharedParams));
                
                // 关闭模态框并更新显示
                shareModal.style.display = 'none';
                updateSharedParamsDisplay();
                showNotification('参数配置已成功分享！');
            }

            // 更新自定义参数范围显示
            function updateCustomRangesDisplay() {
                rangeParamsList.innerHTML = '';
                
                customRanges.forEach(param => {
                    const rangeItem = document.createElement('div');
                    rangeItem.className = 'range-param-item';
                    rangeItem.setAttribute('data-param-id', param.id);
                    
                    rangeItem.innerHTML = `
                        <div class="range-param-header">
                            <h4>${param.name}</h4>
                            <span class="param-desc">${param.description}</span>
                        </div>
                        <div class="range-param-controls">
                            <div class="range-group">
                                <label>开启状态范围</label>
                                <div class="range-inputs">
                                    <input type="number" class="range-min" data-type="activeMin" value="${param.activeMin}" min="0">
                                    <span>至</span>
                                    <input type="number" class="range-max" data-type="activeMax" value="${param.activeMax}" min="0">
                                    <span>${param.unit}</span>
                                </div>
                            </div>
                            <div class="range-group">
                                <label>关闭状态范围</label>
                                <div class="range-inputs">
                                    <input type="number" class="range-min" data-type="inactiveMin" value="${param.inactiveMin}" min="0">
                                    <span>至</span>
                                    <input type="number" class="range-max" data-type="inactiveMax" value="${param.inactiveMax}" min="0">
                                    <span>${param.unit}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    rangeParamsList.appendChild(rangeItem);
                });
            }

            // 保存自定义范围
            function saveCustomRanges() {
                // 收集所有范围值
                document.querySelectorAll('.range-param-item').forEach(item => {
                    const paramId = item.getAttribute('data-param-id');
                    const param = customRanges.find(p => p.id === paramId);
                    
                    if (param) {
                        param.activeMin = parseInt(item.querySelector('[data-type="activeMin"]').value) || 0;
                        param.activeMax = parseInt(item.querySelector('[data-type="activeMax"]').value) || 0;
                        param.inactiveMin = parseInt(item.querySelector('[data-type="inactiveMin"]').value) || 0;
                        param.inactiveMax = parseInt(item.querySelector('[data-type="inactiveMax"]').value) || 0;
                    }
                });
                
                // 保存到本地存储
                localStorage.setItem('weakNetworkCustomRanges', JSON.stringify(customRanges));
                showNotification('自定义参数范围已保存！');
            }

            // 重置自定义范围
            function resetCustomRanges() {
                if (confirm('确定要重置所有参数范围为默认值吗？')) {
                    customRanges = JSON.parse(JSON.stringify(parameters));
                    localStorage.setItem('weakNetworkCustomRanges', JSON.stringify(customRanges));
                    updateCustomRangesDisplay();
                    showNotification('参数范围已重置为默认值！');
                }
            }

            // 导入参数范围
            function importCustomRanges() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = e => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = event => {
                            try {
                                const importedRanges = JSON.parse(event.target.result);
                                if (Array.isArray(importedRanges)) {
                                    customRanges = importedRanges;
                                    localStorage.setItem('weakNetworkCustomRanges', JSON.stringify(customRanges));
                                    updateCustomRangesDisplay();
                                    showNotification('参数范围导入成功！');
                                } else {
                                    alert('无效的参数范围文件格式');
                                }
                            } catch (error) {
                                alert('文件读取失败: ' + error.message);
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            }

            // 导出参数范围
            function exportCustomRanges() {
                const dataStr = JSON.stringify(customRanges, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = '弱网参数范围配置.json';
                link.click();
                
                URL.revokeObjectURL(link.href);
                showNotification('参数范围已导出！');
            }

            // 导出参数
            function exportParameters() {
                // 显示导出选项模态框
                exportOptionsModal.style.display = 'flex';
            }

            // 确认导出参数
            function confirmExport() {
                const exportCurrent = document.getElementById('export-current-params').checked;
                const exportRanges = document.getElementById('export-custom-ranges').checked;
                const exportStats = document.getElementById('export-usage-stats').checked;
                const format = document.getElementById('export-format').value;
                
                let exportData = {
                    version: '3.0',
                    exportTime: new Date().toISOString()
                };
                
                if (exportCurrent) exportData.currentParams = currentParams;
                if (exportRanges) exportData.customRanges = customRanges;
                if (exportStats) exportData.usageStats = usageStats;
                
                let dataStr, filename, mimeType;
                
                if (format === 'json') {
                    dataStr = JSON.stringify(exportData, null, 2);
                    filename = '弱网参数配置.json';
                    mimeType = 'application/json';
                } else if (format === 'text') {
                    dataStr = formatAsText(exportData);
                    filename = '弱网参数配置.txt';
                    mimeType = 'text/plain';
                } else if (format === 'csv') {
                    dataStr = formatAsCSV(exportData);
                    filename = '弱网参数配置.csv';
                    mimeType = 'text/csv';
                }
                
                const dataBlob = new Blob([dataStr], {type: mimeType});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = filename;
                link.click();
                
                URL.revokeObjectURL(link.href);
                exportOptionsModal.style.display = 'none';
                showNotification('参数配置已导出！');
            }

            // 格式化为文本
            function formatAsText(data) {
                let text = '小林弱网参数生成器3.0 - 参数配置导出\n';
                text += '导出时间: ' + new Date(data.exportTime).toLocaleString() + '\n\n';
                
                if (data.currentParams) {
                    text += '=== 当前参数 ===\n';
                    Object.keys(data.currentParams.activeParams).forEach(key => {
                        const param = data.currentParams.activeParams[key];
                        text += `${param.name}: ${param.value}${param.unit}\n`;
                    });
                    text += '\n';
                }
                
                if (data.customRanges) {
                    text += '=== 自定义参数范围 ===\n';
                    data.customRanges.forEach(param => {
                        text += `${param.name}: 开启[${param.activeMin}-${param.activeMax}] 关闭[${param.inactiveMin}-${param.inactiveMax}] ${param.unit}\n`;
                    });
                    text += '\n';
                }
                
                return text;
            }

            // 格式化为CSV
            function formatAsCSV(data) {
                let csv = '参数类型,参数名称,参数值,单位\n';
                
                if (data.currentParams) {
                    Object.keys(data.currentParams.activeParams).forEach(key => {
                        const param = data.currentParams.activeParams[key];
                        csv += `当前参数,${param.name},${param.value},${param.unit}\n`;
                    });
                }
                
                if (data.customRanges) {
                    data.customRanges.forEach(param => {
                        csv += `范围-开启,${param.name},${param.activeMin}-${param.activeMax},${param.unit}\n`;
                        csv += `范围-关闭,${param.name},${param.inactiveMin}-${param.inactiveMax},${param.unit}\n`;
                    });
                }
                
                return csv;
            }

            // 导入参数
            function importParameters() {
                importFileInput.click();
            }

            // 处理导入文件
            importFileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        try {
                            const importedData = JSON.parse(event.target.result);
                            
                            if (importedData.currentParams) {
                                applyHistoryParams(importedData.currentParams);
                            }
                            
                            if (importedData.customRanges) {
                                customRanges = importedData.customRanges;
                                localStorage.setItem('weakNetworkCustomRanges', JSON.stringify(customRanges));
                                updateCustomRangesDisplay();
                            }
                            
                            showNotification('参数配置导入成功！');
                        } catch (error) {
                            alert('文件导入失败: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                    
                    // 重置文件输入
                    importFileInput.value = '';
                }
            });

            // 事件监听
            generateBtn.addEventListener('click', generateParameters);
            copyAllBtn.addEventListener('click', copyAllParameters);
            toggleHistoryBtn.addEventListener('click', toggleHistoryPanel);
            toggleThemeBtn.addEventListener('click', toggleTheme);
            toggleStatsBtn.addEventListener('click', toggleStatsPanel);
            clearHistoryBtn.addEventListener('click', clearHistory);
            resetStatsBtn.addEventListener('click', resetStats);
            closeModalBtn.addEventListener('click', () => {
                historyModal.style.display = 'none';
            });

            // 新增事件监听
            toggleShareBtn.addEventListener('click', toggleSharePanel);
            toggleCustomBtn.addEventListener('click', toggleCustomPanel);
            exportParamsBtn.addEventListener('click', exportParameters);
            importParamsBtn.addEventListener('click', importParameters);
            shareCurrentBtn.addEventListener('click', shareCurrentParams);
            saveRangesBtn.addEventListener('click', saveCustomRanges);
            resetRangesBtn.addEventListener('click', resetCustomRanges);
            importRangesBtn.addEventListener('click', importCustomRanges);
            exportRangesBtn.addEventListener('click', exportCustomRanges);
            confirmShareBtn.addEventListener('click', confirmShare);
            cancelShareBtn.addEventListener('click', () => {
                shareModal.style.display = 'none';
            });
            confirmExportBtn.addEventListener('click', confirmExport);
            cancelExportBtn.addEventListener('click', () => {
                exportOptionsModal.style.display = 'none';
            });

            // 搜索和筛选事件
            paramSearch.addEventListener('input', updateSharedParamsDisplay);
            categoryFilter.addEventListener('change', updateSharedParamsDisplay);

            // 点击模态框外部关闭
            window.addEventListener('click', (event) => {
                if (event.target === historyModal) {
                    historyModal.style.display = 'none';
                }
                if (event.target === shareModal) {
                    shareModal.style.display = 'none';
                }
                if (event.target === exportOptionsModal) {
                    exportOptionsModal.style.display = 'none';
                }
            });

            // 初始化生成参数
            generateParameters();
            updateHistoryPanel();
            updateUsageStatsDisplay();
            
            // 初始化时间显示
            updateTime();
            setInterval(updateTime, 1000);

            // 全局函数，供HTML调用
            window.downloadSharedParam = downloadSharedParam;
            window.rateSharedParam = rateSharedParam;
        });
    </script>
</body>
</html>